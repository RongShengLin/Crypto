︠11483edb-b89b-444d-a88b-1f9652206e7cs︠
#define power function, return P^a mod n
def power(a, P, n):
    T = 1
    while(a != 0):
        if(a % 2 == 1):
            T = (T * P) % n
        P = (P * P) % n
        a = int(a/2)
    return T
#RSA-768
p = 33478071698956898786044169848212690817704794983713768568912431388982883793878002287614711652531743087737814467999489
q = 36746043666799590428244633799627952632279158164343087642676032283815739666511279233373417143396810270092798736308917
n = p * q
phi = (p - 1) * (q - 1)
#ID: B09902117-> 09902117 -> 9902117
ID = 9902117
print("ID = ", ID)
e = 65537
#d = e^-1 mod phi
d = (e^(-1)) % phi
print("1. d = ", d)
#check
print("check = ", (d * e) % phi)
#find (ID)^d mod n directly
S = power(d, ID, n)
print("2. Sign = ", S)
#find S^e mod n to verify
V = power(e, S, n)
print("ID = ", V)

#use chinese remainder theory
#XP = (ID^(d mod (p - 1))) mod p
XP = power(d % (p - 1), ID, p)
#XQ = (ID^(d mod (q - 1))) mod q
XQ = power(d % (q - 1), ID, q)
t = (p^(-1)) % q
u = t*(XQ - XP) % q
CS = (u*p + SP) % n
print("3. Sign = ", CS)
#verify
CV = power(e, CS, n)
print("verify = ", CV)

︡e63f1f92-d376-41db-8dfe-5a09cbdd941b︡{"stdout":"ID =  9902117\n"}︡{"stdout":"1. d =  703813872109751212728960868893055483396831478279095442779477323396386489876250832944220079595968592852532432488202250497425262918616760886811596907743384527001944888359578241816763079495533278518938372814827410628647251148091159553\n"}︡{"stdout":"check =  1\n"}︡{"stdout":"2. Sign =  875837943177977962229861682025112010058737080945747347216255473189525308980346654889153539173610081457886633933351784328873628855172953950645512261791270449600782979395928698314121945605093837767366499742172260201589142374727396681\n"}︡{"stdout":"ID =  9902117\n"}︡{"stdout":"3. Sign =  875837943177977962229861682025112010058737080945747347216255473189525308980346654889153539173610081457886633933351784328873628855172953950645512261791270449600782979395928698314121945605093837767366499742172260201589142374727396681\n"}︡{"stdout":"verify =  9902117\n"}︡{"done":true}









